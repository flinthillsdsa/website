<!-- _includes/nav.html -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top
            {% if page.section == 'resources' or page.collection == 'resources' %}
              navbar-shrink
            {% endif %}"
     id="mainNav" style="background-color:#212529">
  <div class="container">
    <a class="navbar-brand js-scroll-trigger" href="{{ site.baseurl }}/#">
      {%- if site.logo -%}
        <img height="{{ site.logo.height | default: 52 }}" src="{{ site.logo.path }}" />
      {%- else -%}
        {{ site.title }}
      {%- endif -%}
    </a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
            data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
            aria-label="Toggle navigation">
      Menu <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav text-uppercase ml-auto">

        {%- if site.locale and site.locale != "" and site.locale != nil -%}
          {%- assign nav_items = site.data.navigation[site.locale].nav -%}
        {%- else -%}
          {%- assign nav_items = site.data.navigation.nav -%}
        {%- endif -%}

        {%- for link in nav_items -%}

          {%- if link.url -%}
            <li class="nav-item">
              <a class="nav-link" href="{{ link.url | relative_url }}">{{ link.title }}</a>
            </li>

          {%- elsif link.section == "resources" -%}
            {% comment %}
              If on any resources page, show full nested dropdown;
              otherwise show a scroll-to link.
            {% endcomment %}
            {%- if page.section == "resources" -%}
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="resourcesDropdown" role="button"
                   data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  {{ link.title }}
                </a>
                <div class="dropdown-menu" aria-labelledby="resourcesDropdown">

                  <!-- Chapter Documentation group -->
                  <h6 class="dropdown-header">Chapter Documentation</h6>
                  {% assign cd_index = site.resources | where: "path", "chapter-documentation.html" %}
                  {% assign cd_subs  = site.resources | where: "dir",  "chapter-documentation" %}
                  {% for item in cd_index | concat: cd_subs %}
                    <a class="dropdown-item" href="{{ item.url | relative_url }}">{{ item.title }}</a>
                  {% endfor %}
                  <div class="dropdown-divider"></div>

                  <!-- Committees group -->
                  <h6 class="dropdown-header">Committees</h6>
                  {% assign com_index = site.resources | where: "path", "committees.html" %}
                  {% assign com_subs  = site.resources | where: "dir",  "committees" %}
                  {% for item in com_index | concat: com_subs %}
                    <a class="dropdown-item" href="{{ item.url | relative_url }}">{{ item.title }}</a>
                  {% endfor %}
                  <div class="dropdown-divider"></div>

                  <!-- Educational Resources group -->
                  <h6 class="dropdown-header">Educational Resources</h6>
                  {% assign edu_index = site.resources | where: "path", "educational-resources.html" %}
                  {% assign edu_subs  = site.resources | where: "dir",  "educational-resources" %}
                  {% for item in edu_index | concat: edu_subs %}
                    <a class="dropdown-item" href="{{ item.url | relative_url }}">{{ item.title }}</a>
                  {% endfor %}
                  <div class="dropdown-divider"></div>

                  <!-- Working Groups group -->
                  <h6 class="dropdown-header">Working Groups</h6>
                  {% assign wg_index = site.resources | where: "path", "working-groups.html" %}
                  {% assign wg_subs  = site.resources | where: "dir",  "working-groups" %}
                  {% for item in wg_index | concat: wg_subs %}
                    <a class="dropdown-item" href="{{ item.url | relative_url }}">{{ item.title }}</a>
                  {% endfor %}

                </div>
              </li>
            {%- else -%}
              <li class="nav-item">
                <a class="nav-link js-scroll-trigger" href="{{ site.baseurl }}/#resources">{{ link.title }}</a>
              </li>
            {%- endif -%}

          {%- elsif link.section -%}
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="{{ site.baseurl }}/#{{ link.section }}">{{ link.title }}</a>
            </li>

          {%- else -%}
            <li class="nav-item">
              <a class="nav-link" href="#">{{ link.title }}</a>
            </li>
          {%- endif -%}

        {%- endfor -%}

      </ul>
    </div>
  </div>
</nav>
